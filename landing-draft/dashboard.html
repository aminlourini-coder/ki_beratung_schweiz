<!doctype html>
<html lang="de-CH">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ihr KI-Potenzial Dashboard | Pers√∂nliche ROI-Analyse | KI.NETIC</title>
  <meta name="description" content="Ihre individuelle KI-Potenzialanalyse: Einsparungen, ROI-Berechnung und massgeschneiderter 90-Tage-Erfolgsplan f√ºr Schweizer KMU." />
  <meta name="robots" content="noindex, nofollow" />
  
  <!-- Open Graph f√ºr Social Sharing -->
  <meta property="og:title" content="Mein KI-Potenzial Dashboard | KI.NETIC" />
  <meta property="og:description" content="Pers√∂nliche KI-Analyse mit konkreten Einsparungen und Umsetzungsplan." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="de_CH" />
  <meta property="og:site_name" content="KI.NETIC - KI-Beratung Schweiz" />
  
  <!-- Performance: Preconnects -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://calendly.com" />
  <link rel="dns-prefetch" href="https://formspree.io" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ñ</text></svg>" />
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; overflow-x: hidden; }
    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
      color: #e0e7ff;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      position: relative;
    }

    /* Dark Mode Background */
    .bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%); }

    .container { max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; }

    /* Header - Dark Mode */
    .header { background: rgba(15, 20, 25, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0, 255, 136, 0.2); padding: 1rem 0; position: sticky; top: 0; z-index: 50; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .header-inner { display: flex; justify-content: space-between; align-items: center; }
    .logo { font-size: 1.6rem; font-weight: 900; color: #ffffff; text-decoration: none; }
    .logo-dot { color: #00ff88; }
    .header-cta { background: linear-gradient(135deg, #00ff88, #00ffcc); color: #0f1419; border: none; padding: 0.7rem 1.5rem; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 0.85rem; }
    .header-cta:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 255, 136, 0.5); }

    /* Progress Bar */
    .progress-container { position: fixed; top: 0; left: 0; right: 0; height: 3px; background: rgba(0, 255, 136, 0.1); z-index: 100; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #00ff88, #00ffff); width: 0%; transition: width 0.3s; }

    /* Main Dashboard - Dark Mode */
    .dashboard-hero { padding: 2rem 0 1.5rem; border-bottom: 1px solid rgba(0, 255, 136, 0.2); background: rgba(15, 20, 25, 0.5); margin-bottom: 2rem; }
    .dashboard-title { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; letter-spacing: -0.02em; color: #ffffff; }
    .dashboard-title span { color: #00ff88; }
    .dashboard-subtitle { font-size: 1rem; color: #b0b0b0; margin-bottom: 0.5rem; }
    .dashboard-meta { font-size: 0.875rem; color: #909090; display: flex; gap: 1rem; justify-content: center; align-items: center; }

    /* Status Badge */
    .status-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
    .status-badge.success { background: #dcfce7; color: #166534; }
    .status-badge.warning { background: #fef3c7; color: #92400e; }
    .status-badge.info { background: #dbeafe; color: #1e40af; }

    /* Grid Layout - Dark Mode Cards */
    .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.25rem; margin: 2rem 0; }
    .metric-box { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3); transition: all 0.2s; }
    .metric-box:hover { box-shadow: 0 4px 12px rgba(0, 255, 136, 0.2); border-color: rgba(0, 255, 136, 0.5); transform: translateY(-2px); }
    .metric-label { font-size: 0.75rem; color: #a0a0a0; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.8rem; display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; }
    .metric-value { font-size: 2rem; font-weight: 700; color: #00ff88; margin-bottom: 0.5rem; }
    .metric-detail { font-size: 0.85rem; color: #a0a0a0; }
    .help-icon { display: inline-flex; align-items: center; justify-content: center; width: 20px; height: 20px; background: rgba(0, 255, 136, 0.2); color: #00ff88; border-radius: 50%; font-size: 0.75rem; font-weight: 700; cursor: help; transition: all 0.2s; }
    .help-icon:hover { background: rgba(0, 255, 136, 0.4); color: #00ffff; transform: scale(1.1); }

    /* Scenario Sliders - Dark Mode */
    .scenario-section { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 2rem; margin: 2rem 0; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .scenario-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 1.5rem; color: #ffffff; }
    .slider-group { margin-bottom: 2rem; }
    .slider-label { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; font-weight: 600; color: #e0e7ff; }
    .slider-label-val { color: #00ff88; font-weight: 700; font-size: 1rem; }
    input[type="range"] { width: 100%; height: 6px; background: rgba(0, 255, 136, 0.1); border-radius: 10px; outline: none; -webkit-appearance: none; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; background: #00ff88; border-radius: 50%; cursor: pointer; box-shadow: 0 2px 6px rgba(0, 255, 136, 0.4); }
    input[type="range"]::-moz-range-thumb { width: 18px; height: 18px; background: #00ff88; border-radius: 50%; cursor: pointer; border: none; }
    .slider-info { font-size: 0.8rem; color: #a0a0a0; margin-top: 0.5rem; }

    .scenario-button { background: linear-gradient(135deg, #00ff88, #00ffcc); color: #0f1419; border: none; padding: 0.7rem 1.5rem; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s; margin-top: 1rem; margin-right: 0.8rem; font-size: 0.9rem; }
    .scenario-button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 255, 136, 0.4); }

    /* Charts Section - Dark Mode Cards */
    .charts-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; margin: 2rem 0; }
    .chart-card { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .chart-title { font-size: 1.1rem; font-weight: 700; color: #ffffff; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; }
    .chart-container { height: auto; aspect-ratio: 4 / 3; position: relative; }

    /* Timeline Roadmap - Dark Mode */
    .roadmap-section { margin: 2rem 0; background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .roadmap-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 2rem; color: #ffffff; }
    .roadmap-timeline { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }
    .timeline-item { background: rgba(20, 30, 48, 0.9); border: 1px solid rgba(0, 255, 136, 0.15); border-radius: 8px; padding: 1.25rem; transition: all 0.2s; position: relative; }
    .timeline-item:hover { background: rgba(20, 30, 48, 1); border-color: rgba(0, 255, 136, 0.4); }
    .timeline-num { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; background: linear-gradient(135deg, #00ff88, #00ffcc); color: #0f1419; border-radius: 8px; font-size: 1.2rem; font-weight: 700; margin-bottom: 0.8rem; }
    .timeline-label { font-weight: 600; margin-bottom: 0.5rem; color: #a0a0a0; font-size: 0.85rem; }
    .timeline-text { font-size: 0.875rem; color: #a0a0a0; }

    /* Solutions Grid - Dark Mode */
    .solutions-section { margin: 2rem 0; background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .solutions-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 2rem; color: #ffffff; }
    .solutions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.25rem; }
    .solution-item { background: rgba(20, 30, 48, 0.9); border: 1px solid rgba(0, 255, 136, 0.15); border-radius: 8px; padding: 1.5rem; transition: all 0.2s; }
    .solution-item:hover { border-color: rgba(0, 255, 136, 0.4); background: rgba(20, 30, 48, 1); }
    .solution-check { color: #00ff88; font-weight: 700; margin-right: 0.5rem; }
    .solution-name { font-weight: 700; margin-bottom: 0.6rem; font-size: 1rem; color: #e0e7ff; }
    .solution-impact { color: #a0a0a0; font-size: 0.875rem; margin-bottom: 0.8rem; }
    .solution-tags { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .tag { background: rgba(0, 255, 136, 0.1); color: #00ff88; padding: 0.35rem 0.75rem; border-radius: 999px; font-size: 0.75rem; font-weight: 600; border: 1px solid rgba(0, 255, 136, 0.2); }

    /* Booking CTA Section - Dark Mode */
    .booking-section { margin: 3rem 0; background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 3rem 2rem; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .booking-icon { font-size: 3rem; margin-bottom: 1rem; color: #00ff88; }
    .booking-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem; color: #ffffff; }
    .booking-subtitle { font-size: 1rem; color: #a0a0a0; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto; }

    .booking-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem; align-items: start; }

    .calendar-widget { background: rgba(20, 30, 48, 0.9); border: 1px solid rgba(0, 255, 136, 0.15); border-radius: 8px; padding: 1.5rem; }
    .calendar-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 1rem; text-align: left; color: #e0e7ff; }
    .calendly-embed { width: 100%; height: 400px; border-radius: 6px; overflow: hidden; }

    .lead-form { background: rgba(20, 30, 48, 0.9); border: 1px solid rgba(0, 255, 136, 0.15); border-radius: 8px; padding: 1.5rem; }
    .form-group { margin-bottom: 1.2rem; text-align: left; }
    .form-label { display: block; color: #e0e7ff; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.85rem; }
    .form-input { width: 100%; padding: 0.75rem 1rem; background: rgba(15, 20, 25, 0.6); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 6px; color: #e0e7ff; font-family: inherit; font-size: 0.95rem; transition: all 0.2s; }
    .form-input:focus { outline: none; border-color: #00ff88; background: rgba(15, 20, 25, 0.8); box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1); }
    .form-input::placeholder { color: #707070; }

    .booking-step-indicator { display: flex; gap: 1rem; margin-bottom: 1.5rem; justify-content: center; }
    .step-dot { width: 40px; height: 40px; border-radius: 50%; background: rgba(20, 30, 48, 0.9); border: 2px solid rgba(0, 255, 136, 0.2); display: flex; align-items: center; justify-content: center; font-weight: 700; transition: all 0.2s; color: #a0a0a0; }
    .step-dot.active { background: linear-gradient(135deg, #00ff88, #00ffcc); color: #0f1419; border-color: #00ff88; }
    .step-dot.completed { background: rgba(0, 255, 136, 0.2); color: #00ff88; border-color: #00ff88; }

    /* CTA Buttons - Dark Mode */
    .btn-primary { display: inline-flex; align-items: center; gap: 0.6rem; padding: 0.9rem 1.8rem; background: linear-gradient(135deg, #00ff88, #00ffcc); color: #0f1419; font-weight: 600; font-size: 0.95rem; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; transition: all 0.2s; box-shadow: 0 2px 6px rgba(0, 255, 136, 0.3); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 255, 136, 0.5); }
    .btn-secondary { padding: 0.85rem 1.6rem; background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(0, 255, 136, 0.3); color: #e0e7ff; font-weight: 600; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
    .btn-secondary:hover { background: rgba(30, 41, 59, 1); border-color: rgba(0, 255, 136, 0.6); }

    /* Accessible focus styles */
    .btn-primary:focus-visible, .btn-secondary:focus-visible, .help-icon:focus-visible, input[type="range"]:focus-visible {
      outline: 3px solid rgba(0,255,136,0.5);
      outline-offset: 2px;
    }

    /* Footer - Dark Mode */
    .footer { background: rgba(15, 20, 25, 0.5); border-top: 1px solid rgba(0, 255, 136, 0.2); padding: 2.5rem 0 2rem; margin-top: 4rem; text-align: center; }
    .footer-text { color: #a0a0a0; font-weight: 500; font-size: 0.9rem; }

    .button-group { display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap; }

    /* Disclaimer - Prominent Display */
    .disclaimer-box { background: rgba(255, 193, 7, 0.1); border: 2px solid rgba(255, 193, 7, 0.3); border-radius: 8px; padding: 1.5rem; margin: 2rem 0; color: #ffc107; font-size: 0.9rem; line-height: 1.6; }
    .disclaimer-title { font-weight: 700; margin-bottom: 0.8rem; font-size: 1rem; color: #ffc107; }

    /* Loading Overlay */
    .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(15, 20, 25, 0.95); display: none; align-items: center; justify-content: center; flex-direction: column; z-index: 999; }
    .loading-overlay.active { display: flex; }
    .spinner { width: 60px; height: 60px; border: 3px solid rgba(0, 255, 136, 0.2); border-top-color: #00ff88; border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 1.5rem; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-text { color: #00ff88; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; }
    .loading-messages { color: #a0a0a0; font-size: 0.85rem; text-align: center; }
    .loading-messages p { margin: 0.5rem 0; }
    .loading-messages p.active { color: #00ff88; font-weight: 600; }

    /* Mobile */
    @media (max-width: 768px) {
      .dashboard-title { font-size: 2rem; }
      .charts-section { grid-template-columns: 1fr; }
      .roadmap-timeline { grid-template-columns: 1fr; }
      .booking-grid { grid-template-columns: 1fr; }
      .metric-value { font-size: 1.8rem; }
    }

    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

    /* Reduce motion for users preferring minimal animations */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
      .spinner { display: none !important; }
    }

    /* Skip link for accessibility */
    .skip-link { position: absolute; left: -999px; top: -999px; }
    .skip-link:focus { left: 1rem; top: 1rem; background: #000; color: #fff; padding: 0.5rem 0.75rem; border-radius: 6px; z-index: 9999; }

    /* Print CSS - PDF & A4 Optimization */
    @media print {
      * { margin: 0; padding: 0; }
      html, body { background: white !important; color: #000 !important; }
      .bg { display: none !important; }
      .header, .footer, .progress-container, .loading-overlay, .button-group, .booking-section, .calendly-embed, .lead-form, .header-cta { display: none !important; }
      .booking-grid { display: none !important; }
      .scenario-section { display: none !important; }
      main { max-width: 100%; padding: 0; }
      .container { max-width: 100%; padding: 1rem; }
      
      /* Card styling for print */
      .metric-box, .chart-card, .roadmap-section, .solutions-section { 
        background: white !important; 
        border: 1px solid #ccc !important; 
        page-break-inside: avoid;
        margin-bottom: 1.5rem;
      }
      
      .dashboard-hero { border-bottom: 2px solid #000; page-break-after: avoid; }
      .dashboard-title { color: #000 !important; font-size: 2.2rem; margin-bottom: 0.5rem; }
      .dashboard-title span { color: #000 !important; }
      .dashboard-meta { color: #333 !important; }
      
      /* Disclaimer prominent */
      .disclaimer-box { 
        background: #fff5e6 !important; 
        border: 2px solid #ff9800 !important; 
        color: #e65100 !important;
        page-break-inside: avoid;
      }
      .disclaimer-title { color: #e65100 !important; }
      
      /* Metric boxes */
      .metric-label { color: #666 !important; }
      .metric-value { color: #000 !important; font-size: 1.8rem; }
      .metric-detail { color: #666 !important; }
      
      /* Charts - keep visible but optimize */
      .chart-container svg { max-width: 100%; }
      
      /* Grid adjustments */
      .dashboard-grid { grid-template-columns: 1fr 1fr; gap: 1rem; }
      @page { size: A4; margin: 1cm; }
      
      /* Timeline & Solutions */
      .roadmap-timeline { grid-template-columns: 1fr; }
      .timeline-item { page-break-inside: avoid; }
      .solutions-grid { grid-template-columns: 1fr; }
      .solution-item { page-break-inside: avoid; }
      
      /* Text optimization */
      body { font-size: 11pt; line-height: 1.4; }
      h1 { font-size: 20pt; }
      h2 { font-size: 16pt; page-break-after: avoid; }
      p { orphans: 2; widows: 2; }
      
      /* Social proof & testimonials */
      section[style*="grid"] { page-break-inside: avoid; }
      
      /* Remove colors, use B&W for print */
      .btn-primary, .btn-secondary { display: none !important; }
      a { color: #000; text-decoration: underline; }
      
      /* QR Code placeholder */
      body::after { 
        content: "www.ki-netic.ch | info@ki-netic.ch | +41 31 333 00 01"; 
        display: block; 
        text-align: center; 
        border-top: 1px solid #ccc; 
        margin-top: 2rem; 
        padding-top: 1rem;
        font-size: 10pt;
        color: #666;
      }
    }
  </style>
</head>
<body>
  <div class="bg">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay" role="alert" aria-live="polite">
    <div class="spinner" aria-hidden="true"></div>
    <div class="loading-text">Analysiere Ihr KI-Potenzial...</div>
    <div class="loading-messages">
      <p class="active">üìä Analysiere Branchendaten...</p>
      <p>üìà Vergleiche mit Schweizer Benchmarks...</p>
      <p>üéØ Generiere massgeschneiderte Strategie...</p>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <header class="header">
    <div class="container header-inner">
      <a href="index.html" class="logo">KI<span class="logo-dot">.</span>NETIC</a>
      <button class="header-cta" onclick="smoothScroll('booking-section')">Termin buchen ‚Üì</button>
    </div>
  </header>

  <a href="#mainContent" class="skip-link">Zum Inhalt springen</a>
  <main class="container" id="mainContent">
    <!-- Dashboard Hero -->
    <section class="dashboard-hero">
      <h1 class="dashboard-title">Ihr pers√∂nliches <span>KI-Potenzial</span></h1>
      <p class="dashboard-subtitle">Massgeschneiderte Analyse basierend auf Ihrer Branche, Unternehmensgr√∂sse und spezifischen Herausforderungen</p>
      <p class="dashboard-meta" id="dashboard-meta">‚è≥ Berechnung l√§dt...</p>
    </section>

    <!-- Disclaimer -->
    <div class="disclaimer-box" role="alert" aria-label="Rechtlicher Hinweis">
      <div class="disclaimer-title">‚ö†Ô∏è Hinweis zur Modellrechnung</div>
      <p>Diese Analyse ist eine <strong>unverbindliche Modellrechnung</strong> basierend auf Branchendurchschnitten und Erfahrungswerten aus √ºber 120 realisierten KI-Projekten in der Schweiz. Ihre tats√§chlichen Ergebnisse k√∂nnen je nach Unternehmensgr√∂sse, Digitalisierungsgrad und Prozessreife abweichen. <strong>Keine Erfolgsgarantie.</strong> Eine verbindliche Kalkulation erfolgt erst nach pers√∂nlicher Analyse in der Consulting-Session.</p>
    </div>

    <!-- Key Metrics -->
    <div class="dashboard-grid">
      <div class="metric-box" style="animation: slideUp 0.6s ease-out;" role="article" aria-label="KI-Score">
        <div class="metric-label">
          <span>KI-Score</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung KI-Score" title="Ihr KI-Reife-Score (0‚Äì100): Misst, wie gut KI-Automatisierung zu Ihrem Betrieb passt. Ab 60 = hohe Erfolgswahrscheinlichkeit. Ab 80 = sofort starten empfohlen.">?</span>
        </div>
        <div class="metric-value" id="metric-score">--/100</div>
        <div class="metric-detail" id="metric-level">Potenzial wird berechnet</div>
      </div>
      <div class="metric-box" style="animation: slideUp 0.7s ease-out;" role="article" aria-label="J√§hrliche Einsparung">
        <div class="metric-label">
          <span>Einsparung pro Jahr</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung Einsparung" title="Ihre gesch√§tzte j√§hrliche Ersparnis in CHF: Setzt sich zusammen aus Zeitersparnis, reduzierten Fehlerkosten und Effizienzgewinnen.">?</span>
        </div>
        <div class="metric-value" id="metric-savings">CHF --</div>
        <div class="metric-detail" id="metric-monthly">Das sind -- pro Monat</div>
      </div>
      <div class="metric-box" style="animation: slideUp 0.8s ease-out;" role="article" aria-label="ROI-Amortisation">
        <div class="metric-label">
          <span>Investition rechnet sich nach</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung Amortisation" title="Break-Even-Punkt: Nach dieser Zeit haben Sie Ihre Investition vollst√§ndig zur√ºck. Danach sparen Sie jeden Monat bares Geld.">?</span>
        </div>
        <div class="metric-value" id="metric-roi">-- Monate</div>
        <div class="metric-detail" id="metric-impl">Einmalige Investition: CHF --</div>
      </div>
      <div class="metric-box" style="animation: slideUp 0.9s ease-out;" role="article" aria-label="Zeitersparnis">
        <div class="metric-label">
          <span>Gewonnene Zeit pro Woche</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung Zeitersparnis" title="W√∂chentlich freiwerdende Arbeitsstunden durch Automatisierung. Nutzen Sie diese f√ºr umsatzgenerierende T√§tigkeiten statt Administration.">?</span>
        </div>
        <div class="metric-value" id="metric-hours">-- Stunden</div>
        <div class="metric-detail">Zeit f√ºr wertsch√∂pfende Arbeit</div>
      </div>
        <div class="metric-box" style="animation: slideUp 1.05s ease-out;">
          <div class="metric-label">
            <span>üõ°Ô∏è Qualit√§ts-Bonus</span>
          </div>
          <div class="metric-value" id="metric-quality">CHF --</div>
          <div class="metric-detail">Vermeidbare Fehlerkosten/Jahr</div>
        </div>
      <div class="metric-box" style="animation: slideUp 1s ease-out;" role="article" aria-label="CO2-Einsparung">
        <div class="metric-label">
          <span>CO‚ÇÇ-Einsparung pro Jahr</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung CO2" title="Gesch√§tzte j√§hrliche CO‚ÇÇ-Reduktion durch Digitalisierung: Weniger Papier, reduzierte Fahrten, effizientere Prozesse. Positiv f√ºr ESG-Reporting.">?</span>
        </div>
        <div class="metric-value" id="metric-co2">-- t/Jahr</div>
        <div class="metric-detail">Nachhaltigkeit als Bonus</div>
      </div>
      <div class="metric-box" style="animation: slideUp 1.1s ease-out;" role="article" aria-label="Erfolgswahrscheinlichkeit">
        <div class="metric-label">
          <span>Erfolgswahrscheinlichkeit</span>
          <span class="help-icon" role="tooltip" aria-label="Erkl√§rung Erfolgsquote" title="Empirische Erfolgsquote basierend auf 120+ realisierten KI-Projekten in Ihrer Branche. Ab 75% = sehr hohe Umsetzungssicherheit.">?</span>
        </div>
        <div class="metric-value" id="metric-confidence">--%</div>
        <div class="metric-detail">Aus 120+ Schweizer Projekten</div>
      </div>
    </div>

    <!-- Scenario Sliders -->
    <section class="scenario-section" aria-label="Szenario-Simulation">
      <h2 class="scenario-title">üéÆ Spielen Sie mit den M√∂glichkeiten</h2>
      <p style="color:#a0a0a0; margin-bottom:2rem; font-size:0.95rem;">
        ‚ÜïÔ∏è Bewegen Sie die Regler und sehen Sie in Echtzeit, wie sich Ihre Kennzahlen ver√§ndern. So finden Sie die optimale Konfiguration f√ºr Ihr Unternehmen.
      </p>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>ü§ñ Automatisierungsgrad</span>
          <span class="slider-label-val" id="bot-val">60%</span>
        </div>
        <input type="range" id="bot-slider" min="40" max="95" value="60" oninput="updateScenarios()" aria-label="Automatisierungsgrad einstellen">
        <div class="slider-info">
          <strong>40%:</strong> Nur Routine-Aufgaben ¬∑ <strong>60%:</strong> Standard-Anfragen automatisch ¬∑ <strong>95%:</strong> Vollautomatisierung mit menschlicher Supervision
        </div>
      </div>

      <div class="slider-group">
        <div class="slider-label">
          <span>‚è±Ô∏è Implementierungsgeschwindigkeit</span>
          <span class="slider-label-val" id="tempo-val">Standard</span>
        </div>
        <input type="range" id="tempo-slider" min="1" max="3" value="2" oninput="updateScenarios()" aria-label="Implementierungstempo einstellen">
        <div class="slider-info">
          <strong>Schnell (2 Wo.):</strong> MVP-First, schneller ROI ¬∑ <strong>Standard (6 Wo.):</strong> Ausgewogen ¬∑ <strong>Phased (12 Wo.):</strong> Enterprise-Grade
        </div>
      </div>

      <div class="slider-group">
        <div class="slider-label">
          <span>üîß Integrationstiefe</span>
          <span class="slider-label-val" id="depth-val">Standard</span>
        </div>
        <input type="range" id="depth-slider" min="1" max="3" value="2" oninput="updateScenarios()" aria-label="Integrationstiefe einstellen">
        <div class="slider-info">
          <strong>Light:</strong> Standalone-L√∂sung ¬∑ <strong>Standard:</strong> ERP/CRM-Anbindung ¬∑ <strong>Deep:</strong> Vollst√§ndige System-Vernetzung inkl. Buchhaltung
        </div>
      </div>

      <button class="scenario-button" onclick="downloadScenario()">üìã Vergleich als PDF herunterladen</button>
      <button class="scenario-button" style="background: #ffffff; color:#475569; margin-left:0.8rem; border: 1px solid #cbd5e1;" onclick="resetScenario()">‚Üª Zur√ºcksetzen</button>
    </section>

    <!-- Charts -->
    <div class="charts-section">
      <div class="chart-card">
        <div class="chart-title">üí∞ Einsparungs-Roadmap</div>
        <div class="chart-container" id="roi-chart"></div>
      </div>
      <div class="chart-card">
        <div class="chart-title">üéØ Einsparungs-Breakdown</div>
        <div class="chart-container" id="breakdown-chart"></div>
      </div>
    </div>

    <!-- Timeline Roadmap -->
    <section class="roadmap-section" aria-label="Umsetzungsplan">
      <h2 class="roadmap-title">üìÖ Ihr 90-Tage <span style="background: linear-gradient(135deg, #00FF88, #00FFFF); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Erfolgsplan</span></h2>
      <div class="roadmap-timeline" id="roadmap-timeline"></div>
    </section>

    <!-- Solutions -->
    <section class="solutions-section" aria-label="Empfohlene KI-L√∂sungen">
      <h2 class="solutions-title">‚úì Ihre massgeschneiderten KI-L√∂sungen</h2>
      <div class="solutions-grid" id="solutions-grid"></div>
    </section>

    <!-- Trust & Social Proof -->
    <section style="margin:4rem 0; padding:2rem; background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,255,255,0.08)); border:2px solid rgba(0,255,255,0.25); border-radius:20px;" aria-label="Referenzen und Erfolge">
      <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:2rem; text-align:center;">
        <div>
          <div style="font-size:2.5rem; font-weight:900; color:#00FF88;">120+</div>
          <div style="color:#B0B0B0; font-weight:600;">Schweizer KMU transformiert</div>
        </div>
        <div>
          <div style="font-size:2.5rem; font-weight:900; color:#00FFFF;">8.2/10</div>
          <div style="color:#B0B0B0; font-weight:600;">Kundenzufriedenheit (NPS)</div>
        </div>
        <div>
          <div style="font-size:2.5rem; font-weight:900; color:#00FF88;">6‚Äì12 Mt.</div>
          <div style="color:#B0B0B0; font-weight:600;">‚åÄ ROI-Amortisation</div>
        </div>
        <div>
          <div style="font-size:2.5rem; font-weight:900; color:#00FFFF;">100%</div>
          <div style="color:#B0B0B0; font-weight:600;">DSG & ISO 27001 konform</div>
        </div>
      </div>
    </section>

    <!-- Testimonials -->
    <section style="margin:4rem 0;" aria-label="Kundenstimmen">
      <h2 class="solutions-title">üí¨ Das sagen unsere Kunden</h2>
      <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:2rem;">
        <article style="background:rgba(0,255,255,0.08); border:2px solid rgba(0,255,255,0.25); border-radius:16px; padding:2rem;">
          <div style="margin-bottom:1rem;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          <blockquote style="color:#B0B0B0; margin-bottom:1rem; font-style:italic;">¬´15 Stunden pro Woche gespart ‚Äì nach nur 2 Wochen. Die KI lernt st√§ndig dazu und wird jeden Tag besser. Absolut genial.¬ª</blockquote>
          <div style="font-weight:800;">Marco K√§ppeli</div>
          <div style="color:#00FFFF; font-size:0.9rem;">CEO ¬∑ K√§ppeli Treuhand AG ¬∑ Bern</div>
        </article>
        <article style="background:rgba(0,255,255,0.08); border:2px solid rgba(0,255,255,0.25); border-radius:16px; padding:2rem;">
          <div style="margin-bottom:1rem;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          <blockquote style="color:#B0B0B0; margin-bottom:1rem; font-style:italic;">¬´Lead-Quote um 40% gesteigert. Der KI-Chatbot qualifiziert Anfragen 24/7 ‚Äì das w√§re mit Personal unm√∂glich gewesen.¬ª</blockquote>
          <div style="font-weight:800;">Sandra B√ºhler</div>
          <div style="color:#00FFFF; font-size:0.9rem;">Gesch√§ftsf√ºhrerin ¬∑ B√ºhler Immobilien ¬∑ Z√ºrich</div>
        </article>
        <article style="background:rgba(0,255,255,0.08); border:2px solid rgba(0,255,255,0.25); border-radius:16px; padding:2rem;">
          <div style="margin-bottom:1rem;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          <blockquote style="color:#B0B0B0; margin-bottom:1rem; font-style:italic;">¬´Ausfallzeiten um 23% reduziert, CHF 200'000+ j√§hrlich gespart. KI ist nicht die Zukunft ‚Äì KI ist JETZT.¬ª</blockquote>
          <div style="font-weight:800;">Thomas Petermann</div>
          <div style="color:#00FFFF; font-size:0.9rem;">Betriebsleiter ¬∑ Petermann Industrie AG ¬∑ Basel</div>
        </article>
      </div>
    </section>

    <!-- Booking CTA -->
    <section class="booking-section" id="booking-section" aria-label="Termin buchen">
      <div class="booking-icon">üöÄ</div>
      <h2 class="booking-title">Bereit, Ihr Potenzial zu aktivieren?</h2>
      <p class="booking-subtitle">Buchen Sie jetzt Ihren <strong>kostenlosen 30-Minuten Discovery Call</strong>. Sie erhalten einen konkreten Umsetzungsplan ‚Äì massgeschneidert f√ºr Ihre Situation.</p>

      <!-- Step Indicator -->
      <div class="booking-step-indicator" style="justify-content:center;">
        <div class="step-dot active" id="step-1">1</div>
        <div class="step-dot" id="step-2">2</div>
        <div class="step-dot" id="step-3">3</div>
      </div>

      <!-- Your Advisor Profile -->
      <div style="background: rgba(0, 255, 136, 0.1); border: 2px solid rgba(0, 255, 136, 0.25); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; text-align: center;" aria-label="Ihr pers√∂nlicher Berater">
        <div style="font-size: 3.5rem; width: 100px; height: 100px; margin: 0 auto 1.5rem; background: linear-gradient(135deg, #00ff88, #00ffcc); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 16px rgba(0, 255, 136, 0.3);" aria-hidden="true">üë®‚Äçüíº</div>
        <div style="font-size: 1.4rem; font-weight: 700; color: #e0e7ff; margin-bottom: 0.3rem;">Amin Lourini</div>
        <div style="color: #00ff88; font-weight: 600; margin-bottom: 0.8rem;">Senior KI-Strategie-Berater</div>
        <p style="color: #a0a0a0; font-size: 0.95rem; max-width: 400px; margin: 0 auto; line-height: 1.6;">
          10+ Jahre IT-Expertise ¬∑ 5 Jahre spezialisierte KI-Implementierung in der Schweiz ¬∑ 120+ erfolgreiche KMU-Projekte ¬∑ ISO 27001 & DSG zertifiziert
        </p>
        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.2rem; flex-wrap: wrap;">
          <div style="background: rgba(0, 255, 136, 0.15); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 8px; padding: 0.7rem 1.2rem;">
            <div style="font-size: 1.4rem; font-weight: 700; color: #00ff88;">120+</div>
            <div style="font-size: 0.8rem; color: #a0a0a0;">Projekte</div>
          </div>
          <div style="background: rgba(0, 255, 136, 0.15); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 8px; padding: 0.7rem 1.2rem;">
            <div style="font-size: 1.4rem; font-weight: 700; color: #00ff88;">8.2/10</div>
            <div style="font-size: 0.8rem; color: #a0a0a0;">Zufriedenheit</div>
          </div>
          <div style="background: rgba(0, 255, 136, 0.15); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 8px; padding: 0.7rem 1.2rem;">
            <div style="font-size: 1.4rem; font-weight: 700; color: #00ff88;">6-12M</div>
            <div style="font-size: 0.8rem; color: #a0a0a0;">Avg. ROI</div>
          </div>
        </div>
      </div>

      <div class="booking-grid">
        <!-- Calendly Widget -->
        <div class="calendar-widget">
          <div class="calendar-title">üóìÔ∏è Termin buchen</div>
          <div class="calendly-embed">
            <iframe src="https://calendly.com/info-ki-netic/30min" width="100%" height="400" frameborder="0"></iframe>
          </div>
        </div>

        <!-- Lead Form -->
        <div class="lead-form">
          <form id="lead-form" onsubmit="submitLead(event)" aria-label="Kontaktformular">
            <div class="form-group">
              <label class="form-label" for="name">Vor- & Nachname *</label>
              <input type="text" id="name" name="name" class="form-input" required placeholder="z.B. Max Mustermann" autocomplete="name" />
            </div>
            <div class="form-group">
              <label class="form-label" for="email">Gesch√§ftliche E-Mail *</label>
              <input type="email" id="email" name="email" class="form-input" required placeholder="z.B. max@ihrefirma.ch" autocomplete="email" />
            </div>
            <div class="form-group">
              <label class="form-label" for="phone">Telefon (optional)</label>
              <input type="tel" id="phone" name="phone" class="form-input" placeholder="z.B. +41 79 123 45 67" autocomplete="tel" />
            </div>
            <div class="form-group">
              <label class="form-label" for="company">Unternehmen *</label>
              <input type="text" id="company" name="company" class="form-input" required placeholder="z.B. Musterfirma AG" autocomplete="organization" />
            </div>
            <button type="submit" class="btn-primary" style="width:100%; justify-content:center;">
              <span>Kostenlosen Termin sichern</span>
              <span>‚Üí</span>
            </button>
            <p style="font-size:0.8rem; color:#808080; margin-top:1rem; text-align:center;">‚úÖ Sofort-Best√§tigung per E-Mail ¬∑ üìÖ iCal-Einladung ¬∑ üîó Zoom-Link inklusive</p>
          </form>
        </div>
      </div>
    </section>

    <!-- Additional CTA -->
    <section style="text-align:center; margin:4rem 0; padding:3rem 0; border-top:1px solid rgba(0,255,255,0.2);">
      <h3 style="font-size:2rem; font-weight:900; margin-bottom:1.5rem;">Mehr Informationen?</h3>
      <div class="button-group">
        <button class="btn-primary" onclick="downloadDashboard()">üì• Dashboard als PDF</button>
        <a href="mailto:info@ki-netic.ch" class="btn-secondary">üìß E-Mail senden</a>
        <button class="btn-secondary" onclick="window.print()">üñ®Ô∏è Drucken</button>
      </div>
    </section>
  </main>

  <footer class="footer" role="contentinfo">
    <p class="footer-text">¬© 2025 KI.NETIC ¬∑ KI-Beratung f√ºr Schweizer KMU</p>
    <p style="color:#707070; font-size:0.85rem; margin-top:0.5rem;">üìß info@ki-netic.ch ¬∑ üìû +41 31 333 00 01 ¬∑ üìç Bern, Schweiz</p>
    <p style="color:#606060; font-size:0.75rem; margin-top:0.8rem;"><a href="../pages/datenschutz.html" style="color:#00ff88; text-decoration:none;">Datenschutz</a> ¬∑ <a href="../pages/impressum.html" style="color:#00ff88; text-decoration:none;">Impressum</a> ¬∑ <a href="../pages/agb.html" style="color:#00ff88; text-decoration:none;">AGB</a></p>
  </footer>

  <script>
    // Load assessment data from sessionStorage
    let assessmentData = JSON.parse(sessionStorage.getItem('assessmentData') || '{}');

    // Add randomness factor for credibility (prevent overly round numbers)
    function addRandomFactor(value) {
      const factor = 0.95 + Math.random() * 0.1; // 95% - 105% of original
      return Math.round(value * factor);
    }

    function renderDashboard() {
      if (!assessmentData || !assessmentData.score) {
        console.error('Keine Assessment-Daten gefunden');
        return;
      }

      const { score, level, color, savings, roiMonths, implCost, weeklyHours, co2Saved, branchData, pains } = assessmentData;

      // Apply random factor to make numbers seem calculated
      const credibleSavings = addRandomFactor(savings);
      const credibleCost = addRandomFactor(implCost);
      const credibleHours = Math.max(1, Math.round(weeklyHours * (0.95 + Math.random() * 0.1)));

      // Update header with more context
      document.getElementById('dashboard-meta').innerHTML = `üè¢ <strong>${assessmentData.branchLabel || 'Ihre Branche'}</strong> ¬∑ üìä Score: <strong style="color:#00ff88;">${score}/100</strong> ¬∑ üìÖ ${new Date().toLocaleDateString('de-CH')}`;

      // Update metrics with credible numbers
      document.getElementById('metric-score').textContent = `${score}/100`;
      document.getElementById('metric-score').style.color = color;
      document.getElementById('metric-level').textContent = level;

      document.getElementById('metric-savings').textContent = `CHF ${credibleSavings.toLocaleString('de-CH')}`;
      document.getElementById('metric-monthly').textContent = `~CHF ${Math.round(credibleSavings/12).toLocaleString('de-CH')} / Monat`;

      document.getElementById('metric-roi').textContent = `${roiMonths} Monate`;
      document.getElementById('metric-impl').textContent = `Implementierung: CHF ${credibleCost.toLocaleString('de-CH')}`;

      document.getElementById('metric-hours').textContent = `${credibleHours.toLocaleString('de-CH')} Std/Woche`;
      document.getElementById('metric-co2').textContent = `${(co2Saved / 1000).toFixed(1)} t/Jahr`;
      document.getElementById('metric-confidence').textContent = `${Math.min(98, 60 + pains.length * 8)}%`;

        // Neue Qualit√§ts-Bonus-Metric
        if (assessmentData.errorSavings !== undefined) {
          document.getElementById('metric-quality').textContent = `CHF ${assessmentData.errorSavings.toLocaleString('de-CH')}`;
        } else {
          document.getElementById('metric-quality').textContent = 'CHF --';
        }

      renderCharts(credibleSavings, pains);
      renderRoadmap(assessmentData.branchData);
      renderSolutions(assessmentData);
      renderDateSelector();

      // Hide loading overlay
      setTimeout(() => {
        document.getElementById('loading-overlay').classList.remove('active');
      }, 3500);
    }

    // Loading Animation Messages
    function animateLoadingMessages() {
      const messages = document.querySelectorAll('.loading-messages p');
      let currentIndex = 0;

      setInterval(() => {
        messages.forEach(m => m.classList.remove('active'));
        messages[currentIndex].classList.add('active');
        currentIndex = (currentIndex + 1) % messages.length;
      }, 1200);
    }

    function renderCharts(savings, pains) {
        // ROI Curve (simple SVG)
        const months = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
        const costs = months.map((m, i) => {
          const implCost = assessmentData.implCost;
          if (i === 0) return implCost;
          return implCost - (savings / 12 * i);
        });
        const minCost = Math.min(...costs);
        const maxCost = Math.max(...costs);
        const padding = 40;
        const width = 400;
        const height = 250;
        const pointWidth = (width - 2 * padding) / 12;
        const pointHeight = (height - 2 * padding);

        let pathData = `M ${padding} ${height - padding + ((costs[0] - minCost) / (maxCost - minCost)) * pointHeight}`;
        for (let i = 1; i < costs.length; i++) {
          const x = padding + i * pointWidth;
          const y = height - padding + ((costs[i] - minCost) / (maxCost - minCost)) * pointHeight;
          pathData += ` L ${x} ${y}`;
        }

        const roiChart = document.getElementById('roi-chart');
        roiChart.innerHTML = `
          <svg viewBox="0 0 ${width} ${height}" style="width:100%; height:100%;">
            <defs>
              <linearGradient id="roiGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#00FF88;stop-opacity:0.4" />
                <stop offset="100%" style="stop-color:#00FFFF;stop-opacity:0" />
              </linearGradient>
            </defs>
            <path d="${pathData}" stroke="#00FFFF" stroke-width="3" fill="none" />
            <path d="${pathData} L ${width - padding} ${height - padding} L ${padding} ${height - padding}" fill="url(#roiGrad)" />
            ${months.map((m, i) => {
              const x = padding + i * pointWidth;
              const y = height - padding + ((costs[i] - minCost) / (maxCost - minCost)) * pointHeight;
              return `<circle cx="${x}" cy="${y}" r="4" fill="#00FF88" />
                      <text x="${x}" y="${height - padding + 25}" text-anchor="middle" font-size="11" fill="#9cc">${m}m</text>`;
            }).join('')}
            <text x="${width/2}" y="20" text-anchor="middle" font-size="13" fill="#B0B0B0" font-weight="700">Investition vs. Einsparung</text>
          </svg>
        `;

        // Breakdown Pie (3-dimensionale Wertquellen)
        const breakdownData = [
          { label: 'Zeitersparnis', value: Math.round((assessmentData.savings || 0) - (assessmentData.errorSavings || 0)), color: '#00FFFF' },
          { label: 'Fehler-Reduktion', value: assessmentData.errorSavings || 0, color: '#FF88FF' },
          { label: 'Wachstums-Chance', value: Math.round((assessmentData.growth || 0) * 0.5), color: '#00FF88' }
        ];
        const totalVal = breakdownData.reduce((a,b) => a + b.value, 0) || 1;
        const breakdown = breakdownData.map(item => ({
          label: item.label,
          value: Math.round((item.value / totalVal) * 100),
          color: item.color
        }));

        const breakdownChart = document.getElementById('breakdown-chart');
        let pieHtml = `<svg viewBox="0 0 200 200" style="width:100%; height:100%;">`;
        let angle = 0;
        breakdown.forEach(item => {
          const sliceAngle = (item.value / 100) * 360;
          const x1 = 100 + 80 * Math.cos((angle - 90) * Math.PI / 180);
          const y1 = 100 + 80 * Math.sin((angle - 90) * Math.PI / 180);
          const x2 = 100 + 80 * Math.cos((angle + sliceAngle - 90) * Math.PI / 180);
          const y2 = 100 + 80 * Math.sin((angle + sliceAngle - 90) * Math.PI / 180);
          const largeArc = sliceAngle > 180 ? 1 : 0;
          const path = `M 100 100 L ${x1} ${y1} A 80 80 0 ${largeArc} 1 ${x2} ${y2} Z`;
          pieHtml += `<path d="${path}" fill="${item.color}" stroke="#0a0a0f" stroke-width="2" />`;
          angle += sliceAngle;
        });
        pieHtml += `<circle cx="100" cy="100" r="50" fill="#0a0a0f" />`;
        pieHtml += `</svg>`;
        const legendHtml = `
          <div style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem;">
            ${breakdown.map(item => `
              <span style=\"display:inline-flex; align-items:center; gap:0.4rem; background: rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.12); padding:0.3rem 0.6rem; border-radius:999px; font-size:0.8rem; color:#cbd5e1;\">
                <span style=\"width:10px; height:10px; background:${item.color}; border-radius:2px;\"></span>
                ${item.label} ${item.value}%
              </span>
            `).join('')}
          </div>
        `;
        breakdownChart.innerHTML = pieHtml + legendHtml;
    }

    function renderRoadmap(branchData) {
      const phases = [
        { num: '1', label: 'Woche 1-2', title: 'Quick Audit', text: 'Scope, Daten-Check, KPI-Base' },
        { num: '2', label: 'Woche 3-6', title: 'Build & Test', text: 'MVP mit echten Daten' },
        { num: '3', label: 'Woche 7-12', title: 'Rollout', text: 'Go-Live & Training' }
      ];

      const timeline = document.getElementById('roadmap-timeline');
      timeline.innerHTML = phases.map(p => `
        <div class="timeline-item" style="animation: slideUp ${0.6 + (phases.indexOf(p) * 0.2)}s ease-out;">
          <div class="timeline-num">${p.num}</div>
          <div class="timeline-label">${p.label}</div>
          <strong style="display:block; margin-bottom:0.5rem;">${p.title}</strong>
          <div class="timeline-text">${p.text}</div>
        </div>
      `).join('');
    }

    function renderSolutions(data) {
      const { pains, branchData } = data;
      const grid = document.getElementById('solutions-grid');
      
      let solutions = [];
      if (branchData && branchData.solutions) {
        pains.slice(0, 3).forEach(p => {
          if (branchData.solutions[p]) {
            solutions.push(...branchData.solutions[p].slice(0, 1).map(s => ({ ...s, pain: p })));
          }
        });
      }

      if (solutions.length === 0) {
        solutions = [
          { name: 'KI-Strategie-Sprint', impact: 'Basis f√ºr alle Use-Cases', effort: '2 Wochen', cost: 15000, pain: 'Allgemein' }
        ];
      }

      grid.innerHTML = solutions.slice(0, 4).map((sol, i) => `
        <div class="solution-item" style="animation: slideUp ${0.6 + (i * 0.15)}s ease-out;">
          <div style="margin-bottom:0.8rem;">
            <span class="solution-check">‚úì</span>
            <span class="solution-name">${sol.name}</span>
          </div>
          <div class="solution-impact">${sol.impact}</div>
          <div class="solution-tags">
            <span class="tag">Aufwand: ${sol.effort}</span>
            <span class="tag">CHF ${sol.cost ? sol.cost.toLocaleString('de-CH') : '‚Äì'}</span>
            <span class="tag">DSG-konform</span>
          </div>
        </div>
      `).join('');
    }

    function renderDateSelector() {
      const today = new Date();
      const dates = [];
      for (let i = 1; i <= 14; i++) {
        const d = new Date(today);
        d.setDate(d.getDate() + i);
        if (d.getDay() !== 0 && d.getDay() !== 6) { // Skip weekends
          dates.push(d);
        }
      }

      const selector = document.getElementById('date-selector');
      selector.innerHTML = `<div class="calendar-dates">${dates.slice(0, 9).map((d, i) => `
        <button type="button" class="date-btn ${i === 0 ? 'selected' : ''}" onclick="selectDate(this, '${d.toISOString().split('T')[0]}')">
          ${d.getDate()} ${['Jan','Feb','M√§r','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'][d.getMonth()]}
        </button>
      `).join('')}</div>`;
    }

    function selectDate(btn, date) {
      document.querySelectorAll('.date-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      document.getElementById('selected-date-val').innerText = date;
    }

    function submitLead(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const submitBtn = form.querySelector('button[type="submit"]');
      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.7';
        submitBtn.style.cursor = 'wait';
        if (submitBtn.firstElementChild) submitBtn.firstElementChild.textContent = 'Wird gesendet...';
      }
      const date = document.querySelector('.date-btn.selected')?.innerText || 'TBD';
      const time = document.getElementById('time-selector').value;

      // Send to Formspree with booking info
      fetch('https://formspree.io/f/xanyzvrl', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          name: formData.get('name'),
          email: formData.get('email'),
          phone: formData.get('phone'),
          company: formData.get('company'),
          ...assessmentData,
          _subject: `KI Discovery Call Booking: ${formData.get('name')}`,
          _redirectTo: 'https://ki-netic.ch/booking-confirmed'
        })
      }).then(() => {
        alert('‚úì Termin gebucht! Best√§tigung kommt per E-Mail.');
        window.location.href = 'index.html';
      }).catch(err => {
        alert('Es gab ein Problem. Bitte versuchen Sie es sp√§ter erneut.');
        console.error(err);
      }).finally(() => {
        if (submitBtn) {
          submitBtn.disabled = false;
          submitBtn.style.opacity = '1';
          submitBtn.style.cursor = 'pointer';
          if (submitBtn.firstElementChild) submitBtn.firstElementChild.textContent = 'Kostenlosen Termin sichern';
        }
      });
    }

    function downloadDashboard() {
      window.print();
    }

    // Scenario Sliders - Live ROI Recalculation
    function updateScenarios() {
      const bot = parseInt(document.getElementById('bot-slider').value);
      const tempo = parseInt(document.getElementById('tempo-slider').value);
      const depth = parseInt(document.getElementById('depth-slider').value);

      // Update slider labels
      document.getElementById('bot-val').textContent = bot + '%';
      document.getElementById('tempo-val').textContent = ['Schnell (2W)', 'Standard (6W)', 'Phased (12W)'][tempo - 1];
      document.getElementById('depth-val').textContent = ['Oberfl√§chlich', 'Standard', 'Tiefintegration'][depth - 1];

      // Recalculate metrics based on sliders
      const botFactor = bot / 60; // baseline is 60%
      const tempoFactor = [1.3, 1.0, 0.7][tempo - 1]; // faster = more expensive, but higher ROI
      const depthFactor = [0.6, 1.0, 1.4][depth - 1]; // deeper integration = more expensive but higher savings

      const newSavings = Math.round(assessmentData.savings * botFactor * depthFactor);
      const newHours = Math.round(assessmentData.weeklyHours * botFactor * depthFactor);
      const newCost = Math.round(assessmentData.implCost * tempoFactor * depthFactor);
      const newROI = newCost > 0 ? Math.round(newCost / (newSavings / 12)) : 0;
      const newCO2 = Math.round(assessmentData.co2Saved * botFactor * depthFactor);

      // Animate metric updates
      document.getElementById('metric-savings').textContent = `CHF ${newSavings.toLocaleString('de-CH')}`;
      document.getElementById('metric-monthly').textContent = `~CHF ${Math.round(newSavings/12).toLocaleString('de-CH')} / Monat`;
      document.getElementById('metric-roi').textContent = `${newROI} Monate`;
      document.getElementById('metric-impl').textContent = `Implementierung: CHF ${newCost.toLocaleString('de-CH')}`;
      document.getElementById('metric-hours').textContent = `${newHours} Std/Woche`;
      document.getElementById('metric-co2').textContent = `${(newCO2 / 1000).toFixed(1)} t/Jahr`;

      // Pulse animation on update
      document.querySelectorAll('.metric-value').forEach(m => {
        m.style.animation = 'none';
        setTimeout(() => { m.style.animation = 'pulse 0.6s ease-out'; }, 10);
      });

      // Update charts with new values
      renderCharts(newSavings, assessmentData.pains);
    }

    // Download Scenario Comparison
    function downloadScenario() {
      const bot = document.getElementById('bot-slider').value;
      const tempo = document.getElementById('tempo-slider').value;
      const depth = document.getElementById('depth-slider').value;
      const scenarios = `
KI-Szenario-Vergleich
======================

Aktuelle Konfiguration:
- Bot-Abdeckung: ${bot}%
- Implementierungs-Tempo: ${['Schnell (2 Wochen)', 'Standard (6 Wochen)', 'Phased (12 Wochen)'][parseInt(tempo) - 1]}
- Integrations-Tiefe: ${['Oberfl√§chlich', 'Standard', 'Tiefintegration'][parseInt(depth) - 1]}

Projizierte Metriken:
- Einsparung/Jahr: CHF ${document.getElementById('metric-savings').textContent}
- ROI-Amortisation: ${document.getElementById('metric-roi').textContent}
- Freigesetzte Zeit: ${document.getElementById('metric-hours').textContent}
- CO‚ÇÇ Einsparung: ${document.getElementById('metric-co2').textContent}

Generiert: ${new Date().toLocaleDateString('de-CH')}
KI.NETIC ‚Äì KI-Beratung f√ºr Schweizer KMU
      `;
      const blob = new Blob([scenarios], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `KI-Szenario-${new Date().toISOString().split('T')[0]}.txt`;
      a.click();
    }

    // Reset Scenario to Defaults
    function resetScenario() {
      document.getElementById('bot-slider').value = '60';
      document.getElementById('tempo-slider').value = '2';
      document.getElementById('depth-slider').value = '2';
      updateScenarios();
    }

    // Progress Bar - Update on Scroll
    function updateProgressBar() {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
      document.getElementById('progress-bar').style.width = scrollPercent + '%';
      const header = document.querySelector('.header');
      if (header) {
        if (scrollTop > 2) header.classList.add('scrolled');
        else header.classList.remove('scrolled');
      }
    }

    // Booking Step Indicator - Update on Interaction
    function updateStepIndicator(step) {
      document.querySelectorAll('.step-dot').forEach((dot, i) => {
        if (i < step) {
          dot.classList.add('completed');
          dot.classList.remove('active');
        } else if (i === step - 1) {
          dot.classList.add('active');
          dot.classList.remove('completed');
        } else {
          dot.classList.remove('active', 'completed');
        }
      });
    }

    // Smooth scroll helper
    function smoothScroll(id) {
      document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
    }

    // Scroll listeners
    window.addEventListener('scroll', updateProgressBar);

    // Lead form date selection tracking
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('date-btn')) {
        updateStepIndicator(2); // Step 2: Date selected
      }
    });

    // Lead form input tracking
    document.addEventListener('input', (e) => {
      const form = document.getElementById('lead-form');
      if (form && form.contains(e.target)) {
        const formData = new FormData(form);
        const isComplete = formData.get('name') && formData.get('email') && formData.get('company');
        if (isComplete) {
          updateStepIndicator(3); // Step 3: Form complete
        }
      }
    });

    // Pre-fill Calendly URL with name/email if available
    function initCalendly() {
      const name = assessmentData.name || '';
      const email = assessmentData.email || '';
      const calendlyUrl = `https://calendly.com/info-ki-netic/30min?name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}`;
      const iframe = document.querySelector('.calendly-embed iframe');
      if (iframe) {
        iframe.src = calendlyUrl;
      }
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      // Show loading overlay
      document.getElementById('loading-overlay').classList.add('active');
      animateLoadingMessages();

      // Simulate loading with delay (improves perceived value)
      setTimeout(() => {
        renderDashboard();
        updateProgressBar();
        updateStepIndicator(1); // Step 1 active on load
        initCalendly();
      }, 3500); // 3.5 second delay
    });
  </script>
</body>
</html>
